
## Objective
Create a simple home page for our Track App where users can search for **athletes** and **schools**. The search should show any athlete or school where a word in their name matches any of the words typed by the user.

We are focusing on **basic functionality first**. Styling and advanced features can come later.  

The search results will show simple data, in the following format:

```
S Park Tudor School
B Justin Li '26 - Park Tudor School
B Owen Zhang '26 - Park Tudor School
G Kylie Ritz '27 - Park Tudor School
```


*Key: S is for School record, B is for Boy athlete record, and G is for Girl athlete record. 

---

## Justin
**Goal:** Add class year to the athlete table and populate it with the correct class year for every athlete in the table. Once is completed, push Track.db to the repository so Owen has access to this field. 

---

## Owen 

**Goal:** Make the search work on the server side.

### Step 1: Write a search function and helper queries needed. 

In `backend/queries.py`:

```python
def search_athletes_and_schools(query):
    """
    Search for athletes and schools using the entire query.
    Returns a list of dictionaries:
      - Athletes include: name, gender, class_year, school_name
      - Schools include: name
    """
    results = []

    # Call the modified query functions that handle the whole search string
    athletes = query_athletes_matching(query)  # returns unique athletes where a word in the search matches a word in the athlete name
    schools = query_schools_matching(query)    # returns unique schools where a word in the search matches a word in the school name

    for a in athletes:
        results.append({
            'type': a['gender'],
            'name': a['name'],
            'class_year': a['class_year'],
            'school_name': a['school_name']
        })

    for s in schools:
        results.append({
            'type': 'School',
            'name': s['name']
        })

    return results

```

### Step 2: Create a search route

In `backend/routes/api_routes.py`:

```python
from flask import Blueprint, request, jsonify
from backend.queries import search_athletes_and_schools

api = Blueprint('api', __name__)

@api.route('/search')
def search():
    query = request.args.get('query', '')
    results = search_athletes_and_schools(query)
    return jsonify(results)
```

### Step 3: Register the blueprint

In `backend/__init__.py`:

```python
from backend.routes.api_routes import api

app.register_blueprint(api)
```

---

## Arnay 

**Goal:** Let users type a search and see results dynamically.

### Step 1: Create `base.html`

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{% block title %}Track App{% endblock %}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
</head>
<body>
    <header>
        <h1>Track App</h1>
    </header>

    {% block content %}{% endblock %}

    <footer>
        <p>© 2025 Track App</p>
    </footer>

    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>
</html>
```

### Step 2: Create `home.html`

```html
{% extends 'base.html' %}

{% block content %}
<h2>Search for Athletes or Schools</h2>
<input type="text" id="search-box" placeholder="Enter search term">
<button id="search-btn">Search</button>
<div id="results"></div>
{% endblock %}
```

### Step 3: Add JavaScript to handle the search

In `static/js/main.js`:

```javascript
document.getElementById('search-btn').addEventListener('click', () => {
    const searchTerm = document.getElementById('search-box').value;

    fetch(`/search?query=${encodeURIComponent(searchTerm)}`)
        .then(response => response.json())
        .then(data => showResults(data));
});

function showResults(results) {
    const resultsDiv = document.getElementById('results');
    resultsDiv.innerHTML = ''; // Clear previous results
    
    if (results.length === 0) {
        resultsDiv.innerHTML = '<p>No results found.</p>';
        return;
    }

    results.forEach(item => {
        const div = document.createElement('div');
    
        if (item.type === 'School') {
            // For schools, show type and name
            div.textContent = `${item.type}: ${item.name}`;
        } else {
            // For athletes, show type, name, class year, and school
            div.textContent = `${item.type}: ${item.name} '${item.class_year} - ${item.school}`;
        }
    
        resultsDiv.appendChild(div);
    });

}
```

## Overview of how everything works together.

1. User opens the home page → sees the search box.  
2. User types a search term (can be multiple words) and clicks **Search**.  
3. JavaScript sends the search to the backend `/search` route.  
4. Backend searches the database and returns JSON results.  
5. JavaScript updates the page with the results dynamically.  

